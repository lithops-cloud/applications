# Serverless Pipelines in Lithops
We present a summary of serverless benchmarks and pipelines, useful to measure the performance of serverless frameworks like Lithops. We name each parallel call to a set of cloud functions a _stage_.

| Benchmark   | Description     | Language | Stages |     Data set     |     Data format     | LOC |
|:--------|:--------|:--------:|:--------:|:--------:|:--------:|:--------:|
| **General**  ||||||||
| [*FLOPS Computation Test*](#1-flops-computation-test)      | Analyze Lithops performance in FLOPS. | Python3.10 | 1 | Autogenerated    | NumPy array    | 63 |
| [*Object Storage Test*](#2-object-storage-test)      | Measure the bandwidth from a computation backend to storage. | Python3.10 | 2 | Autogenerated    | Bytes    | 286 |
| [*Montecarlo*](#3-montecarlo-simulations)     | Monte Carlo Methods to make computations with a big amount of stochastic data.     | Python3.10 | 1 | Autogenerated    | NumPy array    | 46 |
| [*Mandelbrot classic*](#4-mandelbrot-classic)     | Mandelbrot set calculated on a increasing resoultion.    | Python3.10 | 7 | Autogenerated    | Mandelbrot set | 109 |
| **Machine Learning**     |          |          |          |          |          |
| [*Hyperparameter tunning*](#5-hyperparameter-tunning-with-grid-search)     | Hyperparameter tuning using grid search algorithm. | Python3.10 | 1 | [Amazon customer reviews](https://www.kaggle.com/bittlingmayer/amazonreviews)      | ft.txt     | 111 |
| **Geospatial**     |          |          |          |          |          |
| [*NDVI*](#6-ndvi-calculation)     | Calculate NDVI from Object Storage images.     | Python3.10 | 2 | Sentinel2 satellite image from the [AWS Sentinel2 open data repository](https://registry.opendata.aws/sentinel-2/)      | Cloud-Optimized GeoTIFF (COG)  | 1552 |
| [*Model creation from LiDAR pre-processing*](#7-model-creation-from-lidar-pre-processing)     | Create terrain models using LiDAR partitioner. | Python3.10 | 1 | [laz files](https://www.icgc.cat/es/Descargas/Elevaciones/Datos-lidar)     | laz     | 212 |
| [*Water Consumption*](#8-water-consumption)     |  Calculate water consumption from crops using the Penman-Monteith formula and interpolation raster.  | Python3.10 | 9 |  [Instituto Nacional de Informacion Geográfica](https://centrodedescargas.cnig.es/CentroDescargas/index.jsp)  | Tif files  | 686 |
| **Metabolomics**     |          |          |          |          |          |
| [*METASPACE metabolite annotation*](#9-metaspace-metabolite-annotation-pipeline)     | Run the METASPACE metabolite annotation pipeline on cloud resources. | Python3.8 | 16 | [Examples of datasets and databases](https://github.com/metaspace2020/Lithops-METASPACE#example-datasets)     | imzML     | 2642 |
| **Genomics**    |          |          |          |          |          |
| **Genomics**    |          |          |          |          |          |
| [*Variant Calling*](#10-variant-calling)    | Alignment of sequencing reads, stored as FASTQ files, to a reference genome, stored as a FASTA file. | Python3.10 | 9 | Trypanosome [[Genome](https://tritrypdb.org/tritrypdb/app/downloads/Current_Release/TbruceiTREU927/fasta/data/), [SRR6052133](https://trace.ncbi.nlm.nih.gov/Traces/?view=run_browser&acc=SRR6052133&display=download)], Human [[Genome](http://hgdownload.cse.ucsc.edu/goldenpath/hg19/bigZips/), [SRR15068323](https://trace.ncbi.nlm.nih.gov/Traces/?view=run_browser&acc=SRR15068323&display=data-access) , [ERR9856489](https://trace.ncbi.nlm.nih.gov/Traces/?view=run_browser&acc=ERR9856489&display=data-access)], Bos Taurus [[Genome](https://www.ensembl.org/Bos_taurus/Info/Index), [SRR934415](https://trace.ncbi.nlm.nih.gov/Traces/?view=run_browser&acc=SRR934415&display=data-access)]  | fast, fastq     | 4174 |
| **Astronomics**     |          |          |          |          |          |
| [*Astronomica-interferometry*](#11-astronomica-interferometry)    | Radio interferometry data processing.     | Python3.8 | 2 | [SB205.MS SB206.MS SB207.MS SB208.MS SB209.MS SB210.MS](https://share.obspm.fr/s/ezBfciEfmSs7Tqd?path=%2FDATA)        | MS | 907 |
| **Elastic Exploration**    |          |          |          |          |          |
| [*UTS*](#12-uts)    | The Unbalanced Tree Search (UTS) benchmark.     | Java 11 | 1 | Autogenerated    | Dynamic tree  | 2841 |
| [*Mandelbrot with Mariani Silver*](#13-mandelbrot-with-mariani-silver)    | Render the Mandelbrot set using  Marian-Silver algorithm. | Java 11 | 1 | Autogenerated    | Mandelbrot set  | 2735 |
| [*Betweenness Centrality*](#14-betweenness-centrality)    | Compute the Between Centrality (BC) algorithm.  | Java 11 | 1 | Autogenerated | Graph  | 3119 |
| **Extreme Sorting**  |          |          |          |          |          |
| [*TeraSort*](#15-terasort)    | Implementation of the TeraSort benchmark built on Lithops.     | Python3.10 | 2 | [TeraGen](https://github.com/gfinol/teragen-lithops)    | ascii  | 827 |
||||||**TOTAL:**|**20310**|


In most cases there's a link to an external repository containing the code while others can be found here.

All workflows except the ones in **Elastic Exploration** utilize **[Lithops](https://lithops.cloud)** to easily deploy and run code on any major Cloud serverless platform.

# Benchmarks

For the geospatial benchmarks you first need to follow this [instructions](https://github.com/cloudbutton/geospatial-usecase/blob/main/INSTALL.md) to set up the environment. Find more technical information about Geospatial, Genomics and Metabolomics benchmarks [here](https://cloudbutton.eu/docs/deliverables/CloudButton_D2.5.pdf).

## 1. [FLOPS Computation Test](https://github.com/lithops-cloud/applications/tree/master/benchmarks/flops)

This is a benchmark to estimate the floating-point performance of the system for matrix multiplication operations using NumPy. It measures how many floating-point operations per second the system can perform for this specific operation.

## 2. [Object Storage Test](https://github.com/lithops-cloud/applications/tree/master/benchmarks/object_storage)

This benchmark measures the bandwidth between the storage and computation backends.

## 3. [Montecarlo Simulations](https://github.com/lithops-cloud/applications/tree/master/montecarlo)

This contains two applications in which Monte Carlo Methods is used to make computations with big amount of random data using Cloud Functions with Lithops.

## 4. [Mandelbrot classic](https://github.com/lithops-cloud/applications/tree/master/mandelbrot)

Mandelbrot set calculated on a limited space several times using Lithops. A certain region of the linear space is treated as a matrix and divided into chunks in order to be able to be distributed among many functions. 

## 5. [Hyperparameter Tunning with Grid Search](https://github.com/lithops-cloud/applications/tree/master/sklearn)

Perform hyperparameter tuning using grid search algorithm. We have a dataset consisting of amazon product reviews and a sklearn classifier to classiy these reviews. We take advantage of cloud functions to tune this classifier's hyperparameters and show how Lithops can be used for ML computations.

## 6. [NDVI Calculation](https://github.com/cloudbutton/geospatial-usecase/tree/main/ndvi-diff)

Use case of serverless image processing consuming data from Object Storage, NDVI(Normalized Difference Vegetation Index) is calculated over many images.

## 7. [Model creation](https://github.com/cloudbutton/geospatial-usecase/tree/main/calculate-models) from [LiDAR pre-processing](https://github.com/cloudbutton/geospatial-usecase/tree/main/lidar-partitioner)

We partition LiDAR files based on the denisty of points. With this partitioned data we create several terrain models used in many geospatial workflows. We study the impact of load balancing by partitioning LiDAR data using the aforementioned density-based partitioner.

## 8. [Water Consumption](https://github.com/cloudbutton/geospatial-usecase/tree/main/water-consumption)
Pipeline that calculates water consumption from crops using the Penman-Monteith formula and interpolation rasters of temperature, wind, solar irradiance and humidity for a given day.

## 9. [METASPACE metabolite annotation pipeline](https://github.com/iAmJK44/serverless_pipelines/tree/main/Lithops-METASPACE)
Run the METASPACE (Spatial metabolomics cloud platform that conducts molecular annotation of imaging mass spectrometry data) metabolite annotation pipeline on cloud resources using Lithops. 
The original implementation of this pipeline can be found on [Metaspace repository](https://github.com/metaspace2020/Lithops-METASPACE). We have addapted this implementation to work with Lithops 3.5.1 and with more recent package versions.

More information about this pipeline can be found on this [IBM Blog post](https://www.ibm.com/blog/decoding-dark-molecular-matter-in-spatial-metabolomics-with-ibm-cloud-functions/).

An extended analysis of the pipeline, along with a demonstration of Lithops' VM backend was presented in the [Middleware '24 Industrial Track](https://dl.acm.org/doi/10.1145/3700824.3701095).

## 10. [Variant Calling](https://github.com/CLOUDLAB-URV/serverless-genomics/tree/main)

In genomics, variant calling entails the alignment process, which is essentially a search for string similarities. This process aligns sequencing reads, typically stored as FASTQ files, with a reference genome, which is stored as a FASTA file. The reference genome and reads are split into smaller chunks for alignment.

Our serverless variant calling was presented in the [9th Workshop in Serverless Computing (WOSC)](https://dl.acm.org/doi/abs/10.1145/3631295.3631403).

## 11. [Astronomica Interferometry](https://github.com/iAmJK44/serverless_pipelines/tree/main/serverlessextract)

Processing radio interferometric data performing all the phases: rebinning, calibration and imaging using Lithops. 

We present an adapted version for easier execution. The original implementation can be found at [https://github.com/abourramouss/serverlessextract](https://github.com/abourramouss/serverlessextract).

## 12. [UTS](https://github.com/gfinol/elastic-exploration)

The implementation of UTS presented here is the first that tackles an elastic resource provisioning.

The UTS pipeline was part of a paper showcasing [the use of Cloud Functions in elastic, unbalanced algorithms](https://www.sciencedirect.com/science/article/pii/S0743731524000558).

## 13. [Mandelbrot with Mariani Silver](https://github.com/gfinol/elastic-exploration)

Render the Mandelbrot set using the Marian-Silver algorithm as optimization technique. This algorithm relies on the fact that the Mandelbrot250
set is connected, that is, there is a path between any two points belonging to the set.

## 14. [Betweenness Centrality](https://github.com/gfinol/elastic-exploration)

Computing the Between Centrality (BC) algorithm. The implementation follows the Brandes’ algorithm described in the benchmark, augmenting Dijkstra’s single-source shortest paths (SSSP) algorithm for unweighted graphs.

## 15. [TeraSort](https://github.com/GEizaguirre/terasort-lithops)

Implementation of the TeraSort benchmark (a distributed sort), built on Lithops. Tasks are executed on cloud functions, object storage is used for reading & writing data (including the exchange of itnermediate files).
We have deeply studied serverless data exchanges in a series of publications :
   - [Primula](https://dl.acm.org/doi/10.1145/3429357.3430522)
   - [Seer](https://dl.acm.org/doi/abs/10.1145/3528535.3565241)
   - [Seer*](https://www.sciencedirect.com/science/article/pii/S0743731523001338)

# Corresponding authors

Pipeline tuning, set up and compilation:

#### Pau Balanzà 

[![Email](https://img.shields.io/badge/Email-pau.balanza@estudiants.urv.cat-blue)](mailto:pau.balanza@estudiants.urv.cat)

[![GitHub](https://img.shields.io/badge/GitHub-balanz24-black?logo=github)](https://github.com/balanz24)

#### Jordi Canosa

[![Email](https://img.shields.io/badge/Email-jordi.canosa@estudiants.urv.cat-blue)](mailto:jordi.canosa@estudiants.urv.cat)

[![GitHub](https://img.shields.io/badge/GitHub-iAmJK44-black?logo=github)](https://github.com/iAmJK44)
